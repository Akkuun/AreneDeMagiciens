[gd_resource type="BehaviorTree" load_steps=44 format=3 uid="uid://cqdkws254vlu4"]

[ext_resource type="Script" uid="uid://dt7wqjp2mu2xk" path="res://ai/tasks/is_player_detected.gd" id="1_rsv4q"]
[ext_resource type="Script" uid="uid://by7d5tsqwbafb" path="res://ai/tasks/is_in_range.gd" id="2_07ai8"]
[ext_resource type="PackedScene" uid="uid://bymbxgpk838l0" path="res://Scenes/objects/projectile.tscn" id="2_jswlx"]
[ext_resource type="Script" uid="uid://bjnw6bprdrgl7" path="res://ai/tasks/face_target.gd" id="2_mi6ct"]
[ext_resource type="Script" uid="uid://uja7ux25b6vd" path="res://ai/tasks/shoot_projectile.gd" id="3_mi6ct"]
[ext_resource type="Script" uid="uid://dmx4g6vr6u2c6" path="res://ai/tasks/select_flanking_pos.gd" id="3_rsv4q"]
[ext_resource type="Script" uid="uid://nrg0phxx4b66" path="res://ai/tasks/arrive_pos.gd" id="4_aeqyo"]
[ext_resource type="Script" uid="uid://cpbl4mrwds458" path="res://ai/tasks/update_loose_point.gd" id="5_mh77e"]
[ext_resource type="Script" uid="uid://dpuxx3ag1bpqv" path="res://ai/tasks/select_random_patrol_pos.gd" id="6_jswlx"]

[sub_resource type="BlackboardPlan" id="BlackboardPlan_ocnie"]

[sub_resource type="BTCondition" id="BTCondition_aeqyo"]
script = ExtResource("1_rsv4q")

[sub_resource type="BTRandomWait" id="BTRandomWait_rsv4q"]
min_duration = 1.2
max_duration = 2.3

[sub_resource type="BTCondition" id="BTCondition_t88kj"]
script = ExtResource("2_07ai8")
max_range = 15.0

[sub_resource type="BTAction" id="BTAction_1uvjn"]
script = ExtResource("2_mi6ct")

[sub_resource type="BBNode" id="BBNode_ubene"]
saved_value = NodePath("AnimationPlayer")
resource_name = "AnimationPlayer"

[sub_resource type="BTPlayAnimation" id="BTPlayAnimation_73vhv"]
animation_player = SubResource("BBNode_ubene")
animation_name = &"Spell2"

[sub_resource type="BTWait" id="BTWait_g37qj"]
duration = 1.1

[sub_resource type="BTAction" id="BTAction_deuai"]
script = ExtResource("3_mi6ct")
projectile_scene = ExtResource("2_jswlx")
spawn_offset = Vector3(0, 1, 0)

[sub_resource type="BTWait" id="BTWait_nbewg"]
duration = 2.0

[sub_resource type="BTSequence" id="BTSequence_xoe3s"]
custom_name = "Attack"
children = [SubResource("BTCondition_t88kj"), SubResource("BTAction_1uvjn"), SubResource("BTPlayAnimation_73vhv"), SubResource("BTWait_g37qj"), SubResource("BTAction_deuai"), SubResource("BTWait_nbewg")]
metadata/_weight_ = 4497.157499999997

[sub_resource type="BTAction" id="BTAction_8hgky"]
script = ExtResource("3_rsv4q")
target_var = &"detected_player"
range_min = 5.0
range_max = 8.0

[sub_resource type="BBNode" id="BBNode_qc34b"]
saved_value = NodePath("AnimationPlayer")
resource_name = "AnimationPlayer"

[sub_resource type="BTPlayAnimation" id="BTPlayAnimation_xlr4d"]
animation_player = SubResource("BBNode_qc34b")
animation_name = &"Run"
blend = 0.1

[sub_resource type="BTAction" id="BTAction_hfkjk"]
script = ExtResource("4_aeqyo")
tolerance = 0.7
avoid_var = &"detected_player"

[sub_resource type="BTTimeLimit" id="BTTimeLimit_kde0j"]
time_limit = 7.0
children = [SubResource("BTAction_hfkjk")]

[sub_resource type="BBNode" id="BBNode_07ai8"]
saved_value = NodePath("AnimationPlayer")
resource_name = "AnimationPlayer"

[sub_resource type="BTPlayAnimation" id="BTPlayAnimation_t88kj"]
animation_player = SubResource("BBNode_07ai8")
animation_name = &"Idle"
blend = 0.2

[sub_resource type="BTAction" id="BTAction_t88kj"]
script = ExtResource("2_mi6ct")

[sub_resource type="BTSequence" id="BTSequence_68vw0"]
custom_name = "Change flank"
children = [SubResource("BTAction_8hgky"), SubResource("BTPlayAnimation_xlr4d"), SubResource("BTTimeLimit_kde0j"), SubResource("BTPlayAnimation_t88kj"), SubResource("BTAction_t88kj")]
metadata/_weight_ = 1420.1549999999986

[sub_resource type="BTProbabilitySelector" id="BTProbabilitySelector_0k0x4"]
children = [SubResource("BTSequence_xoe3s"), SubResource("BTSequence_68vw0")]

[sub_resource type="BTSequence" id="BTSequence_jswlx"]
custom_name = "Fight"
children = [SubResource("BTCondition_aeqyo"), SubResource("BTRandomWait_rsv4q"), SubResource("BTProbabilitySelector_0k0x4")]

[sub_resource type="BTAction" id="BTAction_mi6ct"]
script = ExtResource("5_mh77e")

[sub_resource type="BTAction" id="BTAction_07ai8"]
script = ExtResource("6_jswlx")
patrol_radius = 7.0

[sub_resource type="BBNode" id="BBNode_t88kj"]
saved_value = NodePath("AnimationPlayer")
resource_name = "AnimationPlayer"

[sub_resource type="BTPlayAnimation" id="BTPlayAnimation_6n8ae"]
animation_player = SubResource("BBNode_t88kj")
animation_name = &"Walk"
blend = 0.2

[sub_resource type="BTAction" id="BTAction_05aup"]
script = ExtResource("4_aeqyo")
target_position_var = &"patrol_pos"
speed_mode = "walk"
tolerance = 0.7

[sub_resource type="BTTimeLimit" id="BTTimeLimit_aeqyo"]
children = [SubResource("BTAction_05aup")]

[sub_resource type="BBNode" id="BBNode_73vhv"]
saved_value = NodePath("AnimationPlayer")
resource_name = "AnimationPlayer"

[sub_resource type="BTPlayAnimation" id="BTPlayAnimation_g37qj"]
animation_player = SubResource("BBNode_73vhv")
animation_name = &"Idle"
blend = 0.1

[sub_resource type="BTRandomWait" id="BTRandomWait_deuai"]
min_duration = 1.5
max_duration = 2.5

[sub_resource type="BTSequence" id="BTSequence_mh77e"]
custom_name = "Patrol"
children = [SubResource("BTAction_mi6ct"), SubResource("BTAction_07ai8"), SubResource("BTPlayAnimation_6n8ae"), SubResource("BTTimeLimit_aeqyo"), SubResource("BTPlayAnimation_g37qj"), SubResource("BTRandomWait_deuai")]

[sub_resource type="BTSelector" id="BTSelector_jswlx"]
children = [SubResource("BTSequence_jswlx"), SubResource("BTSequence_mh77e")]

[sub_resource type="BTSequence" id="BTSequence_mi6ct"]
custom_name = "MAin"
children = [SubResource("BTSelector_jswlx")]

[resource]
blackboard_plan = SubResource("BlackboardPlan_ocnie")
root_task = SubResource("BTSequence_mi6ct")
